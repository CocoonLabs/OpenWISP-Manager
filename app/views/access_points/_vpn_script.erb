#!/bin/sh

up() {
<% l2vpn_bridges.each do |bridge| %>
  ifup <%= bridge.name %>
  #OpenWRT Bug!
  ifup <%= bridge.name %>
<% end %>

  wifi up
}


down() {
<% l2vpn_bridges.each do |bridge| %>
  ifdown <%= bridge.name %>
<% end %>

  wifi down
}

# <script> tap_dev tap_mtu link_mtu ifconfig_local_ip ifconfig_netmask [ init | restart | ??? ]
eval "last=\${$#}"
case "$last" in
  init)
    up
    ;;
  restart)
    up
    ;;
  *)
    down
    ;;
esac
